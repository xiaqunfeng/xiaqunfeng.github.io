<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="å¤å¤©çš„é£" />



<meta name="description" content="ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æ­å»ºä¸€ä¸ªcephé›†ç¾¤ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ">
<meta property="og:url" content="http://xiaqunfeng.cc/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/index.html">
<meta property="og:site_name" content="å¤å¤©çš„é£çš„åšå®¢">
<meta property="og:description" content="ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æ­å»ºä¸€ä¸ªcephé›†ç¾¤ã€‚">
<meta property="og:updated_time" content="2017-07-17T08:58:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ">
<meta name="twitter:description" content="ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æ­å»ºä¸€ä¸ªcephé›†ç¾¤ã€‚">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="å¤å¤©çš„é£çš„åšå®¢" type="application/atom+xml">



    <link rel="shortcut icon" href="/red_apple.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ | å¤å¤©çš„é£çš„åšå®¢</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?2eeeeb98562c97f7d79f13899ec599cd";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/stark.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">å¤å¤©çš„é£</a></h1>
        </hgroup>

        
        <p class="header-subtitle">å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ğŸ˜</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>èœå•</li>
                        <li>æ ‡ç­¾</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">ä¸»é¡µ</a></li>
                        
                            <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                        
                            <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                        
                            <li><a href="/about/">å…³äºæˆ‘</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/xiaqunfeng" title="GitHub"></a>
                            
                                <a class="fa CSDN" href="http://blog.csdn.net/xiaqunfeng123" title="CSDN"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ceph/">ceph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ganesha/">ganesha</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">machine learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rocksdb/">rocksdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/storage/">storage</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
                    </div>
                </section>
                
                
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">å¤å¤©çš„é£</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/stark.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">å¤å¤©çš„é£</a></h1>
            </hgroup>
            
            <p class="header-subtitle">å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ğŸ˜</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">ä¸»é¡µ</a></li>
                
                    <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                
                    <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                
                    <li><a href="/about/">å…³äºæˆ‘</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/xiaqunfeng" title="GitHub"></a>
                            
                                <a class="fa CSDN" target="_blank" href="http://blog.csdn.net/xiaqunfeng123" title="CSDN"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="æ ‡ç­¾" friends="å‹æƒ…é“¾æ¥" about="å…³äºæˆ‘"/>
</nav>
      <div class="body-wrap"><article id="post-cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/" class="article-date">
      <time datetime="2017-07-17T08:46:33.000Z" itemprop="datePublished">2017-07-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ceph/">ceph</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æ­å»ºä¸€ä¸ªcephé›†ç¾¤ã€‚<br><a id="more"></a></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ˜¯ä»¥å‰çš„ä¸€ä¸ªç¬”è®°ï¼Œæ•´ç†å¹¶åˆ†äº«å‡ºæ¥ï¼Œç»™æœ‰éœ€è¦çš„äººã€‚</p>
<p><strong>ç¯å¢ƒï¼š</strong></p>
<p>ä¸»æœºç³»ç»Ÿï¼šubuntu14.04</p>
<p>cephç‰ˆæœ¬ï¼šceph jewel</p>
<h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1 å‡†å¤‡å·¥ä½œ"></a>1 å‡†å¤‡å·¥ä½œ</h2><h3 id="1-1-ç¡¬ä»¶èµ„æº"><a href="#1-1-ç¡¬ä»¶èµ„æº" class="headerlink" title="1.1 ç¡¬ä»¶èµ„æº"></a>1.1 ç¡¬ä»¶èµ„æº</h3><p>â€‹    <strong>ç¡¬ä»¶é…ç½®</strong>ï¼š5å°äº‘ä¸»æœºï¼Œ4æ ¸4Gå†…å­˜ï¼ŒUbuntu14ç³»ç»Ÿï¼Œæ¯å°æŒ‚è½½1 å—100G çš„SSD å’Œ3 å—200G çš„SATA ç›˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# lsblk</div><div class="line">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</div><div class="line">sr0     11:0    1   436K  0 rom  </div><div class="line">vda    253:0    0    20G  0 disk </div><div class="line">â”œâ”€vda1 253:1    0     2M  0 part </div><div class="line">â”œâ”€vda2 253:2    0   476M  0 part /boot</div><div class="line">â””â”€vda3 253:3    0  19.5G  0 part /</div><div class="line">vdb    253:16   0   100G  0 disk </div><div class="line">vdc    253:32   0   200G  0 disk </div><div class="line">vdd    253:48   0   200G  0 disk </div><div class="line">vde    253:64   0   200G  0 disk</div></pre></td></tr></table></figure>
<p>â€‹    <strong>ç£ç›˜åˆ†åŒº</strong></p>
<p>â€‹    ceph-monå¯ä»¥å’ŒosdèŠ‚ç‚¹æ··å¸ƒï¼Œä½†è¦ç‰©ç†éš”ç¦»ã€‚å•å°æœºå™¨å¯ä»¥ç”±å¤šä¸ªosdè¿›ç¨‹ï¼Œæ¯ä¸ªosdçš„æ•°æ®ç›˜å’Œjournalç›˜åˆ†åˆ«å¤„äºç‹¬ç«‹åˆ†åŒºï¼Œä¸ºäº†é«˜æ€§èƒ½ï¼Œå»ºè®®journalæ”¾åœ¨åœ¨ssdç›˜ï¼Œåˆ†åŒºå¤§å°10Gå³å¯(æ›´ç²¾ç¡®çš„å¤§å°è®¡ç®—å‚è§<a href="http://docs.ceph.com/docs/jewel/rados/configuration/osd-config-ref/#journal-settings" target="_blank" rel="external">è¿™é‡Œ</a>, å¤§è‡´çš„è®¡ç®—åŸåˆ™æ˜¯ ç£ç›˜çš„ååosdæŒä¹…åŒ–é—´éš”çš„ä¸¤å€ï¼Œé»˜è®¤çš„æŒä¹…åŒ–é—´éš”æ˜¯5sï¼ŒæŒ‰ç…§ç£ç›˜åå200Mè®¡ç®—ï¼Œ2Gç©ºé—´å°±å¤Ÿäº†)ã€‚<br>â€‹    ä»¥ä¸Šè¿°çš„æ¨èä¸¾ä¸ªä¾‹å­ï¼š<br>â€‹    æŸæœºå™¨ä¸Šå«æœ‰4Tçš„sataç›˜/dev/sdb, /dev/sdc, /dev/sdcã€‚ssdç›˜480Gï¼Œ/dev/sddã€‚ä½¿ç”¨lsscsiå¯ä»¥çœ‹åˆ°ç£ç›˜çš„ç±»å‹(sata or ssd)ï¼Œfdisk -lå¯ä»¥æŸ¥çœ‹ç£ç›˜å®¹é‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># lsscsi</div><div class="line">[0:0:0:0]    disk    SEAGATE  ST300MM0006      0003  /dev/sda</div><div class="line">[0:0:1:0]    disk    ATA      ST4000NM0033-9ZM SN06  /dev/sdb</div><div class="line">[0:0:2:0]    disk    ATA      ST4000NM0033-9ZM SN06  /dev/sdc</div><div class="line">[0:0:3:0]    disk    ATA      ST4000NM0033-9ZM SN06  /dev/sdd</div><div class="line">[0:0:4:0]    disk    ATA      ST4000NM0033-9ZM SN06  /dev/sde</div><div class="line">[0:0:5:0]    disk    ATA      INTEL SSDSC2BB48 0150  /dev/sdf</div><div class="line">[0:0:6:0]    disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdg</div><div class="line">[0:0:7:0]    disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdh</div><div class="line">[0:0:8:0]    disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdi</div><div class="line">[0:0:9:0]    disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdj</div><div class="line">[0:0:10:0]   disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdk</div><div class="line">[0:0:11:0]   disk    ATA      TOSHIBA MG03ACA4 FL1A  /dev/sdl</div><div class="line">[0:0:12:0]   disk    ATA      INTEL SSDSC2BB48 0150  /dev/sdm</div><div class="line">[0:0:13:0]   enclosu PMCSIERA SXP 24Sx12G      RevB  -</div></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨partedå·¥å…·è¿›è¡Œåˆ†åŒºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">partedÂ  -sÂ  /dev/sdbÂ  mklabel gpt #å¯¹/dev/sdbåˆ†åŒº</div><div class="line">parted /dev/sdb mkpart primary ext4 1 1000000 # ç¬¬ä¸€ä¸ªåˆ†åŒºå ç”¨1Måˆ°1000000Mã€‚</div></pre></td></tr></table></figure>
<p>å¯¹äºssdç›˜ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªåˆ†åŒº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">partedÂ  -sÂ  /dev/sddÂ  mklabel gpt #å¯¹/dev/sdbåˆ†åŒº</div><div class="line">parted /dev/sdb mkpart primary ext4 1 10000 # ç¬¬ä¸€ä¸ªåˆ†åŒºå ç”¨1Måˆ°10000Mã€‚</div><div class="line">parted /dev/sdb mkpart primary ext4 10000 20000#Â </div><div class="line">ç¬¬äºŒä¸ªåˆ†åŒºå ç”¨10000Måˆ°20000Mã€‚</div><div class="line">parted /dev/sdb mkpart primary ext4 20000 30000 #Â </div><div class="line">ç¬¬ä¸‰ä¸ªåˆ†åŒºå ç”¨20000Måˆ°30000Mï¼Œå‰©ä½™çš„åˆ†åŒºå¯ä»¥ç”±ä½ è‡ªç”±åˆ†é…ã€‚</div></pre></td></tr></table></figure>
<p>â€‹    <strong>å®é™…åˆ†åŒºéƒ¨ç½²æ“ä½œ</strong></p>
<p>â€‹    åˆ†åŒºçš„æ—¶å€™è¿™é‡Œä»…é’ˆå¯¹SSDåˆ†3ä¸ªåŒºï¼Œæ¯ä¸ªåŒºç»™æŒ‚è½½åœ¨è¯¥ä¸»æœºä¸Šçš„3ä¸ªSATAç›˜ä½¿ç”¨ã€‚</p>
<blockquote>
<p>ä¸ºcephå‡†å¤‡å¥½ç£ç›˜åˆ†åŒºï¼Œä»…ä½œåˆ†åŒºï¼Œä¸éœ€è¦æŒ‚è½½å’Œå»ºç«‹æ–‡ä»¶ç³»ç»Ÿï¼Œéƒ¨ç½²osdèŠ‚ç‚¹æ—¶ï¼Œcephè‡ªå·±ä¼šåšè¿™ä¸ªå·¥ä½œã€‚</p>
</blockquote>
<p>â€‹    å°†SSDåˆ†ä¸º3ä¸ªä¸»åˆ†åŒºï¼ŒSATAç›˜ä¸€ä¸ªåˆ†åŒºï¼Œç‹¬ç«‹æŒ‚è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# parted -s /dev/vdb mklabel gpt</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# parted /dev/vdb mkpart primary ext4 0 40G</div><div class="line">Warning: The resulting partition is not properly aligned for best performance.</div><div class="line">Ignore/Cancel? Cancel </div><div class="line">#ç”Ÿæˆçš„åˆ†åŒºæ²¡æœ‰æ­£ç¡®åœ°å¯¹é½ä»¥å®ç°æœ€ä½³æ€§èƒ½ã€‚å¿½ç•¥/å–æ¶ˆï¼Ÿ</div></pre></td></tr></table></figure>
<blockquote>
<p>æ­£ç¡®å¯¹é½åˆ†åŒºçš„å¿«é€Ÿåˆ†æ­¥æŒ‡å—ï¼š</p>
<p>â€‹    é¦–å…ˆè·å¾—ä½ é˜µåˆ—çš„alignmentå‚æ•°ï¼š</p>
<p>root@ceph0:~# cat /sys/block/vdb/queue/optimal_io_size<br>0<br>root@ceph0:~# cat /sys/block/vdb/queue/minimum_io_size<br>512<br>root@ceph0:~# cat /sys/block/vdb/alignment_offset<br>0<br>root@ceph0:~# cat /sys/block/vdb/queue/physical_block_size<br>512</p>
<p>â€‹    å…¶æ¬¡ï¼ŒæŠŠoptimal_io_sizeçš„å€¼ä¸alignment_offsetçš„å€¼ç›¸åŠ ï¼Œä¹‹åé™¤ä»¥physical_block_sizeçš„å€¼ã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­æ˜¯ï¼š(512 + 0) / 512 = 1ã€‚è¿™ä¸ªæ•°å€¼æ˜¯åˆ†åŒºèµ·å§‹çš„æ‰‡åŒºã€‚</p>
<p>â€‹    æœ€åï¼Œæ–°çš„partedå‘½ä»¤åº”è¯¥å†™æˆç±»ä¼¼ä¸‹é¢è¿™æ ·</p>
<p>mkpart primary 1s 100%</p>
<p>â€‹    å­—æ¯sæ˜¯å¾ˆæœ‰æ„ä¹‰çš„ï¼šå®ƒå‘Šè¯‰partedï¼Œä½ çš„è¾“å…¥æ˜¯1ä¸ªæ‰‡åŒºï¼Œè€Œä¸æ˜¯1ä¸ªå­—èŠ‚ï¼Œä¹Ÿä¸æ˜¯1å…†å­—èŠ‚ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# parted /dev/vdb mkpart primary ext4 1 40G</div><div class="line">Information: You may need to update /etc/fstab.  </div><div class="line"></div><div class="line">root@ceph0:~# parted /dev/vdb mkpart primary ext4 40G 70G</div><div class="line">Information: You may need to update /etc/fstab.                           </div><div class="line"></div><div class="line">root@ceph0:~# parted /dev/vdb mkpart primary ext4 70G 100G</div><div class="line">Information: You may need to update /etc/fstab.  </div><div class="line"></div><div class="line"># ä¸éœ€è¦updateã€‚partedå‘½ä»¤æ˜¯å®æ—¶ç”Ÿæ•ˆçš„ï¼Œåˆ†åŒºå‘½ä»¤å®Œæˆåå·²ç»å°†åˆ†åŒºè¡¨æ•°æ®å†™å…¥äº†ç¡¬ç›˜ã€‚</div><div class="line"># /etc/fstabæ–‡ä»¶ï¼Œæ˜¯ç³»ç»Ÿçš„è‡ªåŠ¨æŒ‚è½½åˆ†åŒºçš„é…ç½®ã€‚ç›®çš„æ˜¯è®©ç³»ç»Ÿé‡å¯åï¼Œèƒ½å¤Ÿè‡ªåŠ¨å°†æŸä¸ªåˆ†åŒºæŒ‚è½½åˆ°æŒ‡å®šæŒ‚è½½ç‚¹ï¼Œè€Œä¸ç”¨å†æ‰‹åŠ¨mountã€‚</div></pre></td></tr></table></figure>
<p>â€‹    SATAç›˜éœ€è¦ä¸€ä¸ªä¸»åˆ†åŒºï¼Œ200Gå¤§å°ï¼Œåˆ†åŒºè¿‡ç¨‹åŒä¸Šã€‚</p>
<p>â€‹    åˆ†åŒºåçš„ç£ç›˜æŒ‚è½½æ ‘çŠ¶ç»“æ„å›¾ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# lsblk</div><div class="line">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</div><div class="line">sr0     11:0    1   436K  0 rom  </div><div class="line">vda    253:0    0    20G  0 disk </div><div class="line">â”œâ”€vda1 253:1    0     2M  0 part </div><div class="line">â”œâ”€vda2 253:2    0   476M  0 part /boot</div><div class="line">â””â”€vda3 253:3    0  19.5G  0 part /</div><div class="line">vdb    253:16   0   100G  0 disk </div><div class="line">â”œâ”€vdb1 253:17   0  37.3G  0 part </div><div class="line">â”œâ”€vdb2 253:18   0    28G  0 part </div><div class="line">â””â”€vdb3 253:19   0    28G  0 part </div><div class="line">vdc    253:32   0   200G  0 disk </div><div class="line">â””â”€vdc1 253:33   0 186.3G  0 part </div><div class="line">vdd    253:48   0   200G  0 disk </div><div class="line">â””â”€vdd1 253:49   0 186.3G  0 part </div><div class="line">vde    253:64   0   200G  0 disk </div><div class="line">â””â”€vde1 253:65   0 186.3G  0 part</div></pre></td></tr></table></figure>
<p>â€‹    å¯¹å…¶ä»–ä¸»æœºä¸ŠæŒ‚è½½çš„SSDå’ŒSATAç›˜æ“ä½œåŒä¸Šã€‚</p>
<h3 id="1-2-è®¾ç½®sshå…å¯†ç™»å½•-ä»…ä¸»æ§èŠ‚ç‚¹"><a href="#1-2-è®¾ç½®sshå…å¯†ç™»å½•-ä»…ä¸»æ§èŠ‚ç‚¹" class="headerlink" title="1.2 è®¾ç½®sshå…å¯†ç™»å½•(ä»…ä¸»æ§èŠ‚ç‚¹)"></a>1.2 è®¾ç½®sshå…å¯†ç™»å½•(ä»…ä¸»æ§èŠ‚ç‚¹)</h3><p>â€‹    é€‰å®šä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºä¸»æ§èŠ‚ç‚¹ï¼ˆè¿™é‡Œé€‰çš„ceph0ä¸»æœºï¼‰ï¼Œå»ºç«‹ä»ä¸»æ§èŠ‚ç‚¹åˆ°å…¶ä»–èŠ‚ç‚¹çš„å…å¯†ç™»å½•ã€‚ä¸»æ§èŠ‚ç‚¹ä¹Ÿå¯ä»¥å®‰è£…cephã€‚</p>
<p><strong>1 ç”Ÿæˆç§˜é’¥ï¼šssh-keygen</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# ssh-keygen</div></pre></td></tr></table></figure>
<p><strong>2 æ‹·è´å¯†é’¥ï¼šssh-copy-id your_dst_node</strong></p>
<p>â€‹    è¾“å…¥å¯†ç å³å¯ï¼Œå¦‚æœä¸çŸ¥é“å¯†ç ï¼Œåˆ™æŠŠ~/.ssh/id_rsa.pubåŠ å…¥åˆ°ç›®æ ‡æœºå™¨çš„~/.ssh/authorized_keysä¸­äº¦å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# ssh-copy-id root@172.20.0.197</div></pre></td></tr></table></figure>
<p>â€‹    ç„¶åå°±å¯ä»¥å…å¯†ç™»å½•äº†ï¼Œç›´æ¥ <strong>ssh + IP</strong> å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# ssh 172.20.0.197</div></pre></td></tr></table></figure>
<p>â€‹    å¯¹å…¶ä»–æœºå°æœºå™¨çš„æ“ä½œåŒä¸Šã€‚<strong>æ³¨æ„ï¼šä¹Ÿè¦å¯¹æœ¬æœºè®¾ç½®å…å¯†ç™»å½•ã€‚</strong></p>
<p>â€‹    æœ‰äº†å…å¯†ç™»å½•ï¼Œå¯ä»¥æ‰¹é‡çš„æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p><strong>3 è®¾ç½®ä¸»æ§èŠ‚ç‚¹é€šè¿‡sshè®¿é—®å…¶ä»–èŠ‚ç‚¹</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">127.0.0.1       localhost       ceph0</div><div class="line">127.0.1.1       host-192-168-112-190.openstacklocal     host-192-168-112-190</div><div class="line"></div><div class="line">172.20.0.196    ceph0</div><div class="line">172.20.0.197    ceph1</div><div class="line">172.20.0.198    ceph2</div><div class="line">172.20.0.199    ceph3</div><div class="line">172.20.0.200    ceph4</div><div class="line"></div><div class="line"># The following lines are desirable for IPv6 capable hosts</div><div class="line">::1     localhost ip6-localhost ip6-loopback</div><div class="line">ff02::1 ip6-allnodes</div><div class="line">ff02::2 ip6-allrouters</div><div class="line">~                                                                                                                                                      </div><div class="line">~                                                                                                                                                   </div><div class="line">&quot;/etc/hosts&quot; 14L, 340C</div></pre></td></tr></table></figure>
<h3 id="1-3-é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><a href="#1-3-é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰" class="headerlink" title="1.3 é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"></a>1.3 é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</h3><p><strong>1 é˜²ç«å¢™ç›¸å…³</strong></p>
<p>â€‹    Ceph Monitors ä¹‹é—´é»˜è®¤ä½¿ç”¨ 6789 ç«¯å£é€šä¿¡ï¼Œ OSD ä¹‹é—´é»˜è®¤ç”¨ 6800:7300 è¿™ä¸ªèŒƒå›´å†…çš„ç«¯å£é€šä¿¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo firewall-cmd --zone=public --add-port=6789/tcpÂ --permanent</div><div class="line">å¦‚æœæç¤ºå‘½ä»¤ä¸å­˜åœ¨ï¼Œåˆ™å¯ä»¥æ‰¹é‡å®‰è£…</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# sudo firewall-cmd --zone=public --add-port=6789/tcp --permanent</div><div class="line">sudo: unable to resolve host ceph0</div><div class="line">sudo: firewall-cmd: command not found</div></pre></td></tr></table></figure>
<p><strong>2 selinuxç›¸å…³</strong><br>â€‹    è®¾ç½®selinuxï¼Œå¦‚æœæŠ¥å‘½ä»¤ä¸å­˜åœ¨ï¼Œå¯ä»¥å¿½ç•¥è¿™ä¸€æ­¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# sudo setenforce 0</div><div class="line">sudo: setenforce: command not found</div></pre></td></tr></table></figure>
<p>â€‹    å¦‚æœå‘½ä»¤å­˜åœ¨ï¼Œæ‰§è¡Œå¦‚ä¸‹æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo setenforce 0</div></pre></td></tr></table></figure>
<p>â€‹    å¦‚æœå¸Œæœ›æ°¸ä¹…ç”Ÿæ•ˆï¼Œåˆ™ä¿®æ”¹ /etc/selinux/config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">This file controls the state of SELinux on the system.</div><div class="line">SELINUX= can take one of these three values:</div><div class="line">	enforcing - SELinux security policy is enforced.</div><div class="line">	permissive - SELinux prints warnings instead of enforcing.</div><div class="line"> Â Â  disabled - No SELinux policy is loaded.</div><div class="line">SELINUX=disabled</div><div class="line">SELINUXTYPE= can take one of these two values:</div><div class="line">Â Â Â  targeted - Targeted processes are protected,</div><div class="line">Â Â Â  minimum - Modification of targeted policy. Only selectedÂ </div><div class="line">processes are protected.</div><div class="line">Â Â Â  mls - Multi Level Security protection.</div><div class="line">SELINUXTYPE=targeted</div></pre></td></tr></table></figure>
<h3 id="1-4-æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><a href="#1-4-æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰" class="headerlink" title="1.4 æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"></a>1.4 æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</h3><p>1ã€åœ¨å„ Ceph èŠ‚ç‚¹åˆ›å»ºæ–°ç”¨æˆ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# sudo useradd -d /home/ceph -m ceph</div><div class="line">sudo: unable to resolve host ceph0</div></pre></td></tr></table></figure>
<p>â€‹    ç¬¬ä¸€æ¡å‘½ä»¤æ‰§è¡Œåçš„å‘Šè­¦æ²¡å…³ç³»ï¼Œå¦‚æœæƒ³æ¶ˆé™¤ï¼Œå¯ä»¥å‚è€ƒ<a href="http://blog.csdn.net/ichuzhen/article/details/8241847" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/hosts</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#ç„¶åå†localhoståé¢åŠ ä¸Šå½“å‰çš„ä¸»æœºåï¼Œè¿™é‡Œæ˜¯ceph0</div><div class="line">127.0.0.1       localhost       ceph0</div></pre></td></tr></table></figure>
<p>2ã€ç¡®ä¿å„ Ceph èŠ‚ç‚¹ä¸Šæ–°åˆ›å»ºçš„ç”¨æˆ·éƒ½æœ‰ sudo æƒé™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# echo &quot;ceph ALL = (root) NOPASSWD:ALL&quot; | sudo tee /etc/sudoers.d/ceph</div><div class="line">ceph ALL = (root) NOPASSWD:ALL</div><div class="line">root@ceph0:~# sudo chmod 0440 /etc/sudoers.d/ceph</div></pre></td></tr></table></figure>
<h3 id="1-5-å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><a href="#1-5-å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰" class="headerlink" title="1.5 å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"></a>1.5 å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</h3><p>â€‹    ä¸»è¦æ˜¯ç”¨äºceph-monä¹‹é—´çš„æ—¶é—´åŒæ­¥ã€‚åœ¨æ‰€æœ‰ Ceph èŠ‚ç‚¹ä¸Šå®‰è£… NTP æœåŠ¡ï¼ˆç‰¹åˆ«æ˜¯ Ceph Monitor èŠ‚ç‚¹ï¼‰ï¼Œä»¥å…å› æ—¶é’Ÿæ¼‚ç§»å¯¼è‡´æ•…éšœã€‚ç¡®ä¿åœ¨å„ Ceph èŠ‚ç‚¹ä¸Šå¯åŠ¨äº† NTP æœåŠ¡ï¼Œå¹¶ä¸”è¦ä½¿ç”¨åŒä¸€ä¸ª NTP æœåŠ¡å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install ntp</div></pre></td></tr></table></figure>
<blockquote>
<p>å¯ä»¥æš‚æ—¶ä¸è®¾ç½®ï¼Œä¸€èˆ¬å…¬å¸çš„æœåŠ¡å™¨ä¼šæ ¡å‡†æ—¶é—´ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œæ—¶é—´æœåŠ¡å™¨ç½‘ä¸Šç™¾åº¦ä¸€ä¸‹ï¼Œè‡ªè¡Œè®¾ç½®å³å¯ã€‚</p>
</blockquote>
<h3 id="1-6-æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><a href="#1-6-æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰" class="headerlink" title="1.6 æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"></a>1.6 æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</h3><p>â€‹    é¡ºåºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>â€‹    <strong>æ³¨</strong>ï¼šå»ºè®®è¿™é‡Œçš„æºç›´æ¥å†™å›½å†…æº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget -q -O- &apos;https://download.ceph.com/keys/release.asc&apos;Â | sudo apt-keyÂ add -</div><div class="line">echo debÂ https://download.ceph.com/debian-jewel/Â $(lsb_release -sc) mainÂ | sudo tee /etc/apt/sources.list.d/ceph.list</div></pre></td></tr></table></figure>
<p>â€‹    å›½å†…æº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># wget -q -O- &apos;http://mirrors.163.com/ceph/keys/release.asc&apos; &gt; test.asc</div><div class="line"># vim test.asc </div><div class="line"># apt-key add test.asc </div><div class="line">OK</div><div class="line"># echo debÂ http://mirrors.163.com/ceph/debian-jewel/Â $(lsb_release -sc) mainÂ | sudo tee /etc/apt/sources.list.d/ceph.list</div><div class="line">debÂ https://mirrors.163.com/ceph/debian-jewel/Â trusty main</div></pre></td></tr></table></figure>
<p>â€‹    <strong>å®é™…æ‰§è¡Œæƒ…å†µ</strong>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# wget -q -O- &apos;https://download.ceph.com/keys/release.asc&apos;Â | sudo apt-keyÂ add -</div><div class="line">apt-keyÂ add: command not found</div></pre></td></tr></table></figure>
<p>â€‹    å¾ˆè¯¡å¼‚ï¼Œä¸çŸ¥é“ä¸ºå•¥ä¸è¡Œï¼Œæ¢ä¸€ç§æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# wget -q -O- &apos;https://download.ceph.com/keys/release.asc&apos; &gt; test.asc</div><div class="line">root@ceph0:~# apt-key add  test.asc </div><div class="line">OK</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# echo debÂ https://download.ceph.com/debian-jewel/Â $(lsb_release -sc) mainÂ | sudo tee /etc/apt/sources.list.d/ceph.list</div><div class="line">debÂ https://download.ceph.com/debian-jewel/Â trusty main</div></pre></td></tr></table></figure>
<h3 id="1-7-å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·-ä»…ä¸»æ§èŠ‚ç‚¹"><a href="#1-7-å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·-ä»…ä¸»æ§èŠ‚ç‚¹" class="headerlink" title="1.7 å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·(ä»…ä¸»æ§èŠ‚ç‚¹)"></a>1.7 å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·(ä»…ä¸»æ§èŠ‚ç‚¹)</h3><p>â€‹    æ›´æ–°ä½ çš„ä»“åº“ï¼Œå¹¶å®‰è£… ceph-deployï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update &amp;&amp; sudo apt-get install ceph-deploy</div></pre></td></tr></table></figure>
<p>â€‹    <strong>å®é™…æ‰§è¡Œæƒ…å†µ</strong>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# sudo apt-get update &amp;&amp; sudo apt-get install ceph-deploy</div><div class="line">E: Type &apos;debÂ https://download.ceph.com/debian-jewel/Â trusty&apos; is not known on line 1 in source list /etc/apt/sources.list.d/ceph.list</div><div class="line">E: The list of sources could not be read.</div></pre></td></tr></table></figure>
<p>â€‹    æ›¿æ¢cephå›½å†…æº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~# vi /etc/apt/sources.list.d/ceph.list</div><div class="line"></div><div class="line">ä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</div><div class="line">#debÂ http://download.ceph.com/debian-jewel/Â trusty mainÂ </div><div class="line">deb http://mirrors.163.com/ceph/debian-jewel trusty main</div></pre></td></tr></table></figure>
<p>â€‹    ç„¶åæ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update &amp;&amp; sudo apt-get install ceph-deploy</div></pre></td></tr></table></figure>
<h2 id="2-å¯åŠ¨ceph-mon"><a href="#2-å¯åŠ¨ceph-mon" class="headerlink" title="2 å¯åŠ¨ceph-mon"></a>2 å¯åŠ¨ceph-mon</h2><h3 id="2-1-å®‰è£…ceph"><a href="#2-1-å®‰è£…ceph" class="headerlink" title="2.1 å®‰è£…ceph"></a>2.1 å®‰è£…ceph</h3><p>ä½¿ç”¨å›½å†…æºåŠ å¿«å®‰è£…é€Ÿåº¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">export CEPH_DEPLOY_REPO_URL=http://mirrors.163.com/ceph/debian-jewelÂ </div><div class="line">export CEPH_DEPLOY_GPG_URL=http://mirrors.163.com/ceph/keys/release.asc</div></pre></td></tr></table></figure>
<p>###2.2 åˆ›å»ºéƒ¨ç½²çš„ç›®å½•ï¼Œç›®å½•å†…ä¼šç”Ÿæˆcephçš„é…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir my-cluster &amp;&amp; cd my-cluster/</div></pre></td></tr></table></figure>
<h3 id="2-3-é…ç½®æ–°èŠ‚ç‚¹"><a href="#2-3-é…ç½®æ–°èŠ‚ç‚¹" class="headerlink" title="2.3 é…ç½®æ–°èŠ‚ç‚¹"></a>2.3 é…ç½®æ–°èŠ‚ç‚¹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy new your-node-list</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼š<code>ceph-deploy new ceph-0 ceph-1 ceph-2 [other nodeâ€¦]</code></p>
<p>æ­¤æ—¶ä¼šåœ¨my-clusterç›®å½•ä¸‹ç”Ÿæˆå‡ ä¸ªæ–‡ä»¶ï¼Œå¦‚ceph.conf;ceph.mon.keyringç­‰</p>
<p>è®¾ç½®ceph.confï¼Œå¢åŠ ä¸€è¡Œ<code>public network = xxx.xxx.xxx.0/24</code>[å–å†³äºå®é™…çš„ç½‘ç»œ]</p>
<p><strong>å®é™…é…ç½®æ“ä½œ</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph-deploy new ceph0 ceph1 ceph2</div><div class="line">root@ceph0:~/my-cluster# ls</div><div class="line">ceph.conf  ceph-deploy-ceph.log  ceph.mon.keyring  release.asc</div></pre></td></tr></table></figure>
<p>â€‹    çœ‹ä¸€ä¸‹ç½‘ç»œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ifconfig</div><div class="line">eth0      Link encap:Ethernet  HWaddr fa:16:3e:89:b2:7f  </div><div class="line">          inet addr:172.20.0.196  Bcast:172.20.255.255  Mask:255.255.0.0</div></pre></td></tr></table></figure>
<p>â€‹    æˆ‘è¿™é‡Œæ–°å¢åŠ çš„ä¸€è¡Œä¸ºï¼špublic network = xxx.xxx.xxx.0/16</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# vim ceph.conf</div><div class="line">[global]</div><div class="line">fsid = 4d7e1b04-2a4c-45aa-b6fe-a98241db0c2f</div><div class="line">mon_initial_members = ceph0, ceph1, ceph2</div><div class="line">mon_host = 172.20.0.196,172.20.0.197,172.20.0.198</div><div class="line">auth_cluster_required = cephx</div><div class="line">auth_service_required = cephx</div><div class="line">auth_client_required = cephx</div><div class="line"></div><div class="line">public network = 172.20.0.0/16</div></pre></td></tr></table></figure>
<p>###2.4 å®‰è£…è¯¥èŠ‚ç‚¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy install ceph-0 ceph-2 ceph-2 [other node...]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph-deploy install ceph0 ceph1 ceph2</div><div class="line">â€¦â€¦</div><div class="line">â€¦â€¦</div><div class="line">[ceph2][INFO  ] Running command: ceph --version</div><div class="line">[ceph2][DEBUG ] ceph version 10.2.3 (ecc23778eb545d8dd55e2e4735b53cc93f92e65b)</div><div class="line"># ceph0,ceph1,ceph2éƒ½å‡ºç°ä¸Šé¢è¿™ä¸¤è¡Œè¾“å‡ºè¡¨ç¤ºå®‰è£…å®Œæˆ</div></pre></td></tr></table></figure>
<p>###2.5 é…ç½®å¹¶å¯åŠ¨ceph-mon</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy mon create-initial</div></pre></td></tr></table></figure>
<p>â€‹    ç„¶åè¿è¡Œ ceph -så¯ä»¥çœ‹åˆ°å½“å‰é›†ç¾¤çš„çŠ¶æ€ï¼Œ3ä¸ªmonï¼Œæš‚æ—¶æ²¡æœ‰osdï¼Œæœ‰ä¸ªpoolï¼Œpoolçš„pgæ•°ç›®æ˜¯64ä¸ªã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph -s</div><div class="line">    cluster 4d7e1b04-2a4c-45aa-b6fe-a98241db0c2f</div><div class="line">     health HEALTH_ERR</div><div class="line">            no osds</div><div class="line">     monmap e1: 3 mons at &#123;ceph0=172.20.0.196:6789/0,ceph1=172.20.0.197:6789/0,ceph2=172.20.0.198:6789/0&#125;</div><div class="line">            election epoch 4, quorum 0,1,2 ceph0,ceph1,ceph2</div><div class="line">     osdmap e1: 0 osds: 0 up, 0 in</div><div class="line">            flags sortbitwise</div><div class="line">      pgmap v2: 64 pgs, 1 pools, 0 bytes data, 0 objects</div><div class="line">            0 kB used, 0 kB / 0 kB avail</div><div class="line">                  64 creating</div></pre></td></tr></table></figure>
<h2 id="3-æ·»åŠ ceph-osdèŠ‚ç‚¹"><a href="#3-æ·»åŠ ceph-osdèŠ‚ç‚¹" class="headerlink" title="3 æ·»åŠ ceph-osdèŠ‚ç‚¹"></a>3 æ·»åŠ ceph-osdèŠ‚ç‚¹</h2><h3 id="3-1-å®‰è£…cephåˆ°osdèŠ‚ç‚¹"><a href="#3-1-å®‰è£…cephåˆ°osdèŠ‚ç‚¹" class="headerlink" title="3.1 å®‰è£…cephåˆ°osdèŠ‚ç‚¹"></a>3.1 å®‰è£…cephåˆ°osdèŠ‚ç‚¹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy install --release &#123;release-name&#125; node-list</div></pre></td></tr></table></figure>
<p>â€‹    è¿™é‡ŒæŠŠä¹‹å‰è£…monitorå‰æ²¡è£…çš„ä¸»æœºè£…ä¸Šï¼Œæˆ‘è¿™é‡Œè¿˜å‰©ceph3, ceph4æ²¡è£…ï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼ˆå…¶å®å‘½ä»¤é‡Œé€‰æ‹©ç‰ˆæœ¬å·è¿™ä¸ªå¯ä»¥å»æ‰ï¼Œå› ä¸ºé»˜è®¤çš„ä¸‹è½½æºå·²ç»æŒ‡å®šäº†ç‰ˆæœ¬ï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy install --release jewel ceph3 ceph4</div></pre></td></tr></table></figure>
<h3 id="3-2-è®¾ç½®å¹¶å¯åŠ¨osd"><a href="#3-2-è®¾ç½®å¹¶å¯åŠ¨osd" class="headerlink" title="3.2 è®¾ç½®å¹¶å¯åŠ¨osd"></a>3.2 è®¾ç½®å¹¶å¯åŠ¨osd</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ceph-deploy osd prepare ceph-4:/dev/vdb1:/dev/vde1Â ceph-4:/dev/vdc1:/dev/vde2 ceph-4:/dev/vdd1:/dev/vde3 #ç£ç›˜å‡†å¤‡</div><div class="line">ssh ceph-4 &apos;chown ceph:ceph /dev/vdb1 /dev/vdc1 /dev/vdd1 /dev/vde1Â /dev/vde2 /dev/vde3&apos; # è®¾ç½®æƒé™</div><div class="line">ceph-deploy osd activate ceph-4:/dev/vdb1:/dev/vde1Â ceph-4:/dev/vdc1:/dev/vde2 ceph-4:/dev/vdd1:/dev/vde3 #å¯åŠ¨osd</div></pre></td></tr></table></figure>
<p>â€‹    ä¸Šè¿°ä»£ç ä¼šåœ¨ceph-4æœºå™¨åˆ›å»ºä¸‰ä¸ªosdè¿›ç¨‹ï¼Œç£ç›˜ç»„åˆ/dev/vdb1:/dev/vde1çš„vdb1ä½œä¸ºç¬¬ä¸€ä¸ªosdçš„æ•°æ®ç›˜ï¼Œvde1ä½œä¸ºjournalç›˜ã€‚ç„¶åè¿è¡Œceph -sï¼Œå¯ä»¥çœ‹åˆ°osdèŠ‚ç‚¹å·²ç»åŠ å…¥ã€‚</p>
<p>å…·ä½“æ‰§è¡Œå¦‚ä¸‹ï¼š</p>
<p><strong>1 ç£ç›˜å‡†å¤‡</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph-deploy osd prepare ceph0:/dev/vdc1:/dev/vdb1 ceph0:/dev/vdd1:/dev/vdb2 ceph0:/dev/vde1:/dev/vdb3</div><div class="line">â€¦â€¦</div><div class="line">â€¦â€¦</div><div class="line">[ceph0][INFO  ] checking OSD status...</div><div class="line">[ceph0][DEBUG ] find the location of an executable</div><div class="line">[ceph0][INFO  ] Running command: /usr/bin/ceph --cluster=ceph osd stat --format=json</div><div class="line">[ceph_deploy.osd][DEBUG ] Host ceph0 is now ready for osd use.</div></pre></td></tr></table></figure>
<p><strong>2 è®¾ç½®æƒé™</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ssh ceph0 &apos;chown ceph:ceph /dev/vdb1 /dev/vdb2 /dev/vdb3 /dev/vdc1 /dev/vdd1 /dev/vde1&apos;</div></pre></td></tr></table></figure>
<p><strong>3 å¯åŠ¨OSD</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph-deploy osd activate ceph0:/dev/vdc1:/dev/vdb1 ceph0:/dev/vdd1:/dev/vdb2 ceph0:/dev/vde1:/dev/vdb3</div><div class="line">â€¦â€¦</div><div class="line">â€¦â€¦</div><div class="line">[ceph0][INFO  ] checking OSD status...</div><div class="line">[ceph0][DEBUG ] find the location of an executable</div><div class="line">[ceph0][INFO  ] Running command: /usr/bin/ceph --cluster=ceph osd stat --format=json</div></pre></td></tr></table></figure>
<p>â€‹    å…¶ä»–å››å°ä¸»æœºä¸Šçš„OSDè®¾ç½®åŒä¸Šï¼Œæ³¨æ„SSDç›˜ç¬¦å’ŒSATAç›˜ç¬¦çš„ä¸åŒã€‚</p>
<p>â€‹    æ‰€æœ‰äº”å°æœºå™¨è®¾ç½®å®Œåï¼Œè¿è¡Œceph -sï¼Œå¯ä»¥çœ‹åˆ°15ä¸ªosdèŠ‚ç‚¹å·²ç»åŠ å…¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph0:~/my-cluster# ceph -s</div><div class="line">    cluster 4d7e1b04-2a4c-45aa-b6fe-a98241db0c2f</div><div class="line">     health HEALTH_WARN</div><div class="line">            too few PGs per OSD (12 &lt; min 30)</div><div class="line">     monmap e1: 3 mons at &#123;ceph0=172.20.0.196:6789/0,ceph1=172.20.0.197:6789/0,ceph2=172.20.0.198:6789/0&#125;</div><div class="line">            election epoch 4, quorum 0,1,2 ceph0,ceph1,ceph2</div><div class="line">     osdmap e80: 15 osds: 15 up, 15 in</div><div class="line">            flags sortbitwise</div><div class="line">      pgmap v181: 64 pgs, 1 pools, 0 bytes data, 0 objects</div><div class="line">            525 MB used, 2792 GB / 2792 GB avail</div><div class="line">                  64 active+clean</div></pre></td></tr></table></figure>
<p><strong>4 è®¾ç½®ä½¿é›†ç¾¤å¤„äºå¥åº·çŠ¶æ€</strong></p>
<p><strong>æ³¨æ„ä¸Šé¢çš„ceph å¤„äº HEALTH_WARN çŠ¶æ€</strong></p>
<p>æŸ¥çœ‹å‰¯æœ¬æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph osd dump | grep &apos;replicated size&apos;</div><div class="line">pool 0 &apos;rbd&apos; replicated size 3 min_size 2 crush_ruleset 0 object_hash rjenkins pg_num 64 pgp_num 64 last_change 1 flags hashpspool stripe_width 0</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å·²ç»å­˜åœ¨çš„pools</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph osd lspools</div><div class="line">0 rbd,</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹rbd poolä¸­çš„ pg_num å’Œ pgp_num å±æ€§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph osd pool get rbd pg_num</div><div class="line">pg_num: 64</div><div class="line">root@ceph0:/etc/ceph# ceph osd pool get rbd pgp_num</div><div class="line">pgp_num: 64</div></pre></td></tr></table></figure>
<p>å¥åº·çš„ pg_num å’Œ pgp_num è®¡ç®—æ–¹æ³•ï¼š</p>
<p>â€‹    å…³äºpgmapçš„æ•°ç›®ï¼Œ<strong>osd_num *100 / replica_num</strong>ï¼Œ<strong>å‘ä¸Šå–2çš„å¹‚</strong>ã€‚æ¯”å¦‚15ä¸ªosdï¼Œä¸‰å¤‡ä»½ï¼Œ15 *100/3=500ï¼Œå¾—åˆ°pg_num = 512ï¼Œçº¿ä¸Šé‡æ–°è®¾å®šè¿™ä¸ªæ•°å€¼æ—¶ä¼šå¼•èµ·æ•°æ®è¿ç§»ï¼Œè¯·è°¨æ…å¤„ç†ã€‚</p>
<p>è®¾ç½®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph osd pool set rbd pg_num 512</div><div class="line">set pool 0 pg_num to 512</div><div class="line">root@ceph0:/etc/ceph# ceph osd pool set rbd pgp_num 512</div><div class="line">set pool 0 pgp_num to 512</div><div class="line">root@ceph0:/etc/ceph#</div></pre></td></tr></table></figure>
<p>å†æ¬¡æŸ¥çœ‹ ceph é›†ç¾¤çŠ¶æ€ï¼ŒHEALTH_OK</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph -s</div><div class="line">    cluster 4d7e1b04-2a4c-45aa-b6fe-a98241db0c2f</div><div class="line">     health HEALTH_OK</div><div class="line">     monmap e1: 3 mons at &#123;ceph0=172.20.0.196:6789/0,ceph1=172.20.0.197:6789/0,ceph2=172.20.0.198:6789/0&#125;</div><div class="line">            election epoch 4, quorum 0,1,2 ceph0,ceph1,ceph2</div><div class="line">     osdmap e84: 15 osds: 15 up, 15 in</div><div class="line">            flags sortbitwise</div><div class="line">      pgmap v226: 512 pgs, 1 pools, 0 bytes data, 0 objects</div><div class="line">            561 MB used, 2792 GB / 2792 GB avail</div><div class="line">                 512 active+clean</div><div class="line">root@ceph0:/etc/ceph#</div></pre></td></tr></table></figure>
<h2 id="4-è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡"><a href="#4-è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡" class="headerlink" title="4 è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡"></a>4 è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡</h2><p>â€‹    ç¡®ä¿cephå­˜å‚¨é›†ç¾¤å¤„äº active + clean çš„çŠ¶æ€ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨å—è®¾å¤‡ã€‚</p>
<h3 id="4-1-å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»"><a href="#4-1-å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»" class="headerlink" title="4.1 å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»"></a>4.1 å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»</h3><p>â€‹    å‚è§ä¸Šæ–‡ï¼šç« èŠ‚1.2ã€‚</p>
<h3 id="4-2-å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™"><a href="#4-2-å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™" class="headerlink" title="4.2 å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™"></a>4.2 å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™</h3><p>â€‹    å‡è®¾rbdæ‰€åœ¨æœºå™¨çš„hostnameä¸º ceph-cliï¼ˆè¿™é‡Œæ–°å»ºä¸€å°ä¸»æœºï¼Œåä¸ºceph-cliï¼‰ã€‚åœ¨<strong>ä¸»æ§èŠ‚ç‚¹ä¸Š</strong>çš„ /etc/ceph ç›®å½•ä¸‹æ‰§è¡Œæ“ä½œã€‚</p>
<p>â€‹    1 åœ¨ceph0ä¸Šä½¿ç”¨ceph-deploy å·¥å…·cephäºŒè¿›åˆ¶ç¨‹åºå®‰è£…åˆ°ceph-cliä¸Šé¢</p>
<p>â€‹    æ³¨æ„ï¼šåœ¨ ceph-cli ä¸»æœºä¸Šå°†ceph æºæ”¹ä¸ºå›½å†…æºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /etc/ceph/ # ä¸»æ§èŠ‚ç‚¹</div><div class="line">ceph-deploy install ceph-cli</div></pre></td></tr></table></figure>
<p>â€‹    2 å°†cephé…ç½®æ–‡ä»¶ï¼ˆceph.confï¼‰å¤åˆ¶åˆ°ceph-cli</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ceph-deploy config push ceph-cli</div></pre></td></tr></table></figure>
<p>â€‹    3 å®¢æˆ·æœºéœ€è¦cephå¯†é’¥å»è®¿é—®cephé›†ç¾¤ã€‚cephåˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤ç”¨æˆ· client.adminï¼Œå®ƒæœ‰è¶³å¤Ÿçš„æƒé™å»è®¿é—®cephé›†ç¾¤ã€‚ä¸å»ºè®®æŠŠclient.adminå…±äº«åˆ°æ‰€æœ‰å…¶ä»–å®¢æˆ·ç«¯èŠ‚ç‚¹ã€‚æ›´å¥½çš„åšæ³•æ˜¯ç”¨åˆ†å¼€çš„å¯†é’¥åˆ›å»ºä¸€ä¸ªæ–°çš„cephç”¨æˆ·å»è®¿é—®ç‰¹å®šçš„å­˜å‚¨æ± ã€‚</p>
<p>â€‹    è¿™é‡Œï¼Œåˆ›å»ºäº†ä¸€ä¸ªcephç”¨æˆ· client.rbdï¼Œå®ƒæ‹¥æœ‰è®¿é—®rbdå­˜å‚¨æ± çš„æƒé™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph auth get-or-create client.rbd mon &apos;allow r&apos; osd &apos;allow class-read object_prefix rbd_children, allow rwx pool=rbd&apos;</div><div class="line">[client.rbd]</div><div class="line">	key = AQAmVzVYzXDjBhAAWlcdtEnQ6XBscmU58ZljAw==</div></pre></td></tr></table></figure>
<p>â€‹    4 ä¸ºceph-cliä¸Šçš„client.rbdç”¨æˆ·æ·»åŠ å¯†é’¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ceph auth get-or-create client.rbd | ssh ceph-cli &apos;sudo tee /etc/ceph/ceph.client.rbd.keyring&apos;</div><div class="line">sudo: unable to resolve host ceph-cli</div><div class="line">[client.rbd]</div><div class="line">	key = AQAmVzVYzXDjBhAAWlcdtEnQ6XBscmU58ZljAw==</div></pre></td></tr></table></figure>
<p>â€‹    5 è‡³æ­¤ï¼Œceph-cli åº”è¯¥å‡†å¤‡å¥½å……å½“cephå®¢æˆ·ç«¯äº†ã€‚é€šè¿‡æä¾›ç”¨æˆ·åå’Œå¯†é’¥åœ¨ ceph-cli ä¸Šæ£€æŸ¥é›†ç¾¤çš„çŠ¶æ€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">root@ceph0:/etc/ceph# ssh ceph-cli &apos;cat /etc/ceph/ceph.client.rbd.keyring &gt;&gt; /etc/ceph/keyring&apos;</div><div class="line"></div><div class="line">root@ceph0:/etc/ceph# ssh ceph-cli &apos;ceph -s --name client.rbd&apos;</div><div class="line">    cluster 4d7e1b04-2a4c-45aa-b6fe-a98241db0c2f</div><div class="line">     health HEALTH_OK</div><div class="line">     monmap e1: 3 mons at &#123;ceph0=172.20.0.196:6789/0,ceph1=172.20.0.197:6789/0,ceph2=172.20.0.198:6789/0&#125;</div><div class="line">            election epoch 4, quorum 0,1,2 ceph0,ceph1,ceph2</div><div class="line">     osdmap e84: 15 osds: 15 up, 15 in</div><div class="line">            flags sortbitwise</div><div class="line">      pgmap v232: 512 pgs, 1 pools, 0 bytes data, 0 objects</div><div class="line">            547 MB used, 2792 GB / 2792 GB avail</div><div class="line">                 512 active+clean</div></pre></td></tr></table></figure>
<p>â€‹    è‡³æ­¤ï¼Œcephå®¢æˆ·ç«¯å·²ç»é…ç½®å®Œæ¯•ã€‚æ¥ä¸‹æ¥åœ¨å®¢æˆ·ç«¯ä¸Šåˆ›å»ºå—è®¾å¤‡ã€‚</p>
<h3 id="4-3-åˆ›å»ºcephå—è®¾å¤‡"><a href="#4-3-åˆ›å»ºcephå—è®¾å¤‡" class="headerlink" title="4.3 åˆ›å»ºcephå—è®¾å¤‡"></a>4.3 åˆ›å»ºcephå—è®¾å¤‡</h3><p>â€‹    1 åˆ›å»ºä¸€ä¸ª102400M å¤§å°çš„RADOS å—è®¾å¤‡ï¼Œå–å rbd1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# rbd create rbd1 --size 102400 --name client.rbd --image-feature layering</div><div class="line"># 14.04çš„å†…æ ¸åªæ”¯æŒlayeringï¼Œå¢åŠ ä¸æ”¯æŒçš„ç‰¹æ€§ä¼šå¯¼è‡´åç»­çš„mapå¤±è´¥ã€‚</div></pre></td></tr></table></figure>
<p>â€‹    2 åˆ—å‡ºRBD é•œåƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# rbd ls --name client.rbd</div><div class="line">rbd1</div></pre></td></tr></table></figure>
<p>â€‹    3 æ£€æŸ¥rbd é•œåƒçš„ç»†èŠ‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# rbd --image rbd1 info --name client.rbd</div><div class="line">rbd image &apos;rbd1&apos;:</div><div class="line">	size 102400 MB in 25600 objects</div><div class="line">	order 22 (4096 kB objects)</div><div class="line">	block_name_prefix: rbd_data.10912ae8944a</div><div class="line">	format: 2</div><div class="line">	features: layering</div><div class="line">	flags:</div></pre></td></tr></table></figure>
<h3 id="4-4-æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–"><a href="#4-4-æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–" class="headerlink" title="4.4 æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–"></a>4.4 æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–</h3><p>â€‹    1 æ˜ å°„å—è®¾å¤‡åˆ° ceph-cli</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# rbd map --image rbd1 --name client.rbd</div><div class="line">/dev/rbd0</div></pre></td></tr></table></figure>
<p>â€‹    2 æ£€æŸ¥è¢«æ˜ å°„çš„å—è®¾å¤‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# rbd showmapped --name client.rbd</div><div class="line">id pool image snap device    </div><div class="line">0  rbd  rbd1  -    /dev/rbd0</div></pre></td></tr></table></figure>
<p>â€‹    3 è¦ä½¿ç”¨è¿™ä¸ªå—è®¾å¤‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¹¶æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# fdisk -l /dev/rbd0</div><div class="line"></div><div class="line">#åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</div><div class="line">root@ceph-cli:~# mkfs.ext4 /dev/rbd0</div><div class="line"></div><div class="line">#åˆ›å»ºæ–‡ä»¶å¤¹ ceph-disk1ï¼Œå¹¶å°†å—è®¾å¤‡ rbd0 æŒ‚è½½åœ¨è¯¥ç›®å½•ä¸‹</div><div class="line">root@ceph-cli:~# mkdir /mnt/ceph-disk1 &amp;&amp; mount /dev/rbd0 /mnt/ceph-disk1</div><div class="line"></div><div class="line">root@ceph-cli:~# df -h /mnt/ceph-disk1</div><div class="line">Filesystem      Size  Used Avail Use% Mounted on</div><div class="line">/dev/rbd0        99G   60M   94G   1% /mnt/ceph-disk1</div></pre></td></tr></table></figure>
<h3 id="4-5-æµ‹è¯•å—è®¾å¤‡"><a href="#4-5-æµ‹è¯•å—è®¾å¤‡" class="headerlink" title="4.5 æµ‹è¯•å—è®¾å¤‡"></a>4.5 æµ‹è¯•å—è®¾å¤‡</h3><p>â€‹    æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹å¯¹è¿™ä¸ªå—å­˜å‚¨è¿›è¡Œä»»æ„è¯»å†™äº†ã€‚å¯ä»¥ä½¿ç”¨ddæˆ–è€…fioè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œæ³¨æ„fioæ˜¯ç ´åæ€§æµ‹è¯•ï¼Œä¼šæ¯åæ•°æ®ç”šè‡³æ–‡ä»¶ç³»ç»Ÿã€‚ä¸è¿‡ç ´åäº†ä¹Ÿæ²¡å…³ç³»ï¼Œåˆ é™¤rbdè®¾å¤‡åï¼Œé‡æ–°æ·»åŠ rbdè®¾å¤‡ï¼Œæ ¼å¼åŒ–å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root@ceph-cli:~# dd if=/dev/zero of=/mnt/ceph-disk1/file1 count=100 bs=1M</div><div class="line">100+0 records in</div><div class="line">100+0 records out</div><div class="line">104857600 bytes (105 MB) copied, 0.12931 s, 811 MB/s</div></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/">cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ</a></p>
        <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="å›åˆ°ä¸»é¡µ">å¤å¤©çš„é£</a></p>
        <p><span>å‘å¸ƒæ—¶é—´:</span>2017-07-17, 16:46:33</p>
        <p><span>æœ€åæ›´æ–°:</span>2017-07-17, 16:58:52</p>
        <p>
            <span>åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/" title="cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ">http://xiaqunfeng.cc/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/</a>
            <span class="copy-path" data-clipboard-text="åŸæ–‡: http://xiaqunfeng.cc/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/ã€€ã€€ä½œè€…: å¤å¤©çš„é£" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/07/17/centosä¸‹cephéƒ¨ç½²/">
                    centosä¸‹cephéƒ¨ç½²
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/07/12/fioæµ‹è¯•ceph/">
                    fioæµ‹è¯•ceph
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å‰è¨€"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-å‡†å¤‡å·¥ä½œ"><span class="toc-number">2.</span> <span class="toc-text">1 å‡†å¤‡å·¥ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-ç¡¬ä»¶èµ„æº"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 ç¡¬ä»¶èµ„æº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-è®¾ç½®sshå…å¯†ç™»å½•-ä»…ä¸»æ§èŠ‚ç‚¹"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 è®¾ç½®sshå…å¯†ç™»å½•(ä»…ä¸»æ§èŠ‚ç‚¹)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 é˜²ç«å¢™åŠå®‰å…¨è®¾ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 æ·»åŠ cephç”¨æˆ·ï¼Œå¹¶è®¾ç½®æƒé™ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><span class="toc-number">2.5.</span> <span class="toc-text">1.5 å®‰è£…ntpæœåŠ¡ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰"><span class="toc-number">2.6.</span> <span class="toc-text">1.6 æ·»åŠ cephå®‰è£…æºï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·-ä»…ä¸»æ§èŠ‚ç‚¹"><span class="toc-number">2.7.</span> <span class="toc-text">1.7 å®‰è£…ceph-deployéƒ¨ç½²å·¥å…·(ä»…ä¸»æ§èŠ‚ç‚¹)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-å¯åŠ¨ceph-mon"><span class="toc-number">3.</span> <span class="toc-text">2 å¯åŠ¨ceph-mon</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-å®‰è£…ceph"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 å®‰è£…ceph</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-é…ç½®æ–°èŠ‚ç‚¹"><span class="toc-number">3.2.</span> <span class="toc-text">2.3 é…ç½®æ–°èŠ‚ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-æ·»åŠ ceph-osdèŠ‚ç‚¹"><span class="toc-number">4.</span> <span class="toc-text">3 æ·»åŠ ceph-osdèŠ‚ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-å®‰è£…cephåˆ°osdèŠ‚ç‚¹"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 å®‰è£…cephåˆ°osdèŠ‚ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-è®¾ç½®å¹¶å¯åŠ¨osd"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 è®¾ç½®å¹¶å¯åŠ¨osd</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡"><span class="toc-number">5.</span> <span class="toc-text">4 è®¾ç½®cephçš„rbdå—å­˜å‚¨è®¾å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 å»ºç«‹ä¸»æ§æœºå™¨åˆ°rbdæ‰€åœ¨è®¾å¤‡çš„sshå…å¯†ç™»å½•å…³ç³»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 å®‰è£…cephç¯å¢ƒï¼Œå¹¶æˆäºˆæƒé™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-åˆ›å»ºcephå—è®¾å¤‡"><span class="toc-number">5.3.</span> <span class="toc-text">4.3 åˆ›å»ºcephå—è®¾å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–"><span class="toc-number">5.4.</span> <span class="toc-text">4.4 æ˜ å°„å—è®¾å¤‡å¹¶åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-æµ‹è¯•å—è®¾å¤‡"><span class="toc-number">5.5.</span> <span class="toc-text">4.5 æµ‹è¯•å—è®¾å¤‡</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">

    <script>
        yiliaConfig.toc = ["éšè—ç›®å½•", "æ˜¾ç¤ºç›®å½•", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="åˆ†äº«åˆ°æ¨ç‰¹"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œã€€| å¤å¤©çš„é£çš„åšå®¢ã€€","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://xiaqunfeng.cc/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/';
            this.page.identifier = '2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//null.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/07/17/centosä¸‹cephéƒ¨ç½²/" title="ä¸Šä¸€ç¯‡: centosä¸‹cephéƒ¨ç½²">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="æ–‡ç« åˆ—è¡¨"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/07/12/fioæµ‹è¯•ceph/" title="ä¸‹ä¸€ç¯‡: fioæµ‹è¯•ceph">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/11/macä¸Šå®‰è£…python3/">macä¸Šå®‰è£…python3</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/30/lsblkå‘½ä»¤/">lsblkå‘½ä»¤</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/29/Syntax-error-unexpected/">Syntax error: '(' unexpected</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/ceph-osdç›¸å…³æ“ä½œ/">ceph osdç›¸å…³æ“ä½œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/07/gitå¸¸ç”¨å‘½åæ€»ç»“/">gitå¸¸ç”¨å‘½åæ€»ç»“</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/05/python3-OS-module/">python3 OS module</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/03/ä¸ºä»€ä¹ˆå¯¹äºä¼ä¸šNASæ¥è¯´NFS-ganeshaæ˜¯ä¸€ä¸ªæ›´å¥½çš„NFS-server/">ä¸ºä»€ä¹ˆå¯¹äºä¼ä¸šNASæ¥è¯´NFS-ganeshaæ˜¯ä¸€ä¸ªæ›´å¥½çš„NFS server</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/01/ceph-peeringè¿‡ç¨‹åˆ†æ/">ceph peeringè¿‡ç¨‹åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/28/ceph-placement-group/">ceph placement group</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/28/Remove-Big-RBD-Image/">Remove Big RBD Image</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/centosä¸‹cephéƒ¨ç½²/">centosä¸‹cephéƒ¨ç½²</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/17/cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ/">cephéƒ¨ç½²å®Œå…¨æ‰‹å†Œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/fioæµ‹è¯•ceph/">fioæµ‹è¯•ceph</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/07/centos7ä¸Šå®‰è£…python3/">centos7ä¸Šå®‰è£…python3</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/XFS-vs-EXT4/">XFS vs EXT4</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/06/ceph-luminousæ–°å‘½ä»¤æ¢ç´¢/">ceph luminousæ–°å‘½ä»¤æ¢ç´¢</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/04/ceph-Luminousæ–°åŠŸèƒ½ä¹‹crush-class/">ceph Luminousæ–°åŠŸèƒ½ä¹‹crush class</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/29/ceph-Luminousåˆæ¢/">ceph Luminous dashboardåˆæ¢</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/28/Ceph-v12-1-0-Luminous-RC-released/">Ceph v12.1.0 Luminous RC released</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/23/wgetæ‰¹é‡ä¸‹è½½httpç›®å½•åŠæ–‡ä»¶/">wgetæ‰¹é‡ä¸‹è½½httpç›®å½•åŠæ–‡ä»¶</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/16/å…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„åŒºåˆ«/">å…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„åŒºåˆ«</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/16/centos-7ä¸‹æ“çºµcephè¿›ç¨‹/">centos 7ä¸‹æ“çºµcephè¿›ç¨‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/15/vimç§»åŠ¨å…‰æ ‡/">vimç§»åŠ¨å…‰æ ‡</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/07/Map-RBD-Devices-on-NBD/">Map RBD Devices on NBD</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/06/ceph-rbd-map-failed/">ceph rbd map failed</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/ceph-monæ—¶é’Ÿåç§»é—®é¢˜/">ceph monæ—¶é’Ÿåç§»é—®é¢˜</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/GPG-key-retrieval-failure/">GPG key retrieval failure</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/macä¸Šå®ç°vimçš„markdowné¢„è§ˆ/">macä¸Šå®ç°vimçš„markdowné¢„è§ˆ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/23/cephæ—¥å¿—è¿ç§»/">cephæ—¥å¿—è¿ç§»</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/11/cpuæ‹“æ‰‘ç»“æ„/">cpuæ‹“æ‰‘åŠcephä½¿ç”¨æ—¶çš„ä¼˜åŒ–</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/07/firewalldå’Œiptables/">firewalldå’Œiptables</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/07/S-M-A-R-T-ç£ç›˜å¥åº·çŠ¶æ€ç›‘æµ‹å·¥å…·/">S.M.A.R.T--ç£ç›˜å¥åº·çŠ¶æ€ç›‘æµ‹å·¥å…·</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/04/iterm2é…è‰²/">iterm2é…è‰²--zsh & oh-my-zsh</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/03/nginxä½¿ç”¨å’Œé…ç½®/">nginxä½¿ç”¨å’Œé…ç½®</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/02/iterm2å¿«æ·é”®çš„ä½¿ç”¨/">iterm2å¿«æ·é”®çš„ä½¿ç”¨</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/02/VSMéƒ¨ç½²/">VSMéƒ¨ç½²</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/å¸¸ç”¨gitå‘½ä»¤æ¸…å•/">å¸¸ç”¨gitå‘½ä»¤æ¸…å•</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/ç†è§£socketç¼–ç¨‹/">ç†è§£socketç¼–ç¨‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/09/cowå’Œrowå¿«ç…§æœºåˆ¶çš„åŒºåˆ«/">cowå’Œrowå¿«ç…§æœºåˆ¶çš„åŒºåˆ«</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/09/Machine-Learning-Yearning-5ã€6/">Machine Learning Yearning(5ã€6ã€7)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/03/Machine-Learning-Yearning-3ã€4/">Machine Learning Yearning(3ã€4)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/02/Machine-Learning-Yearning-å¼€ç¯‡ã€1ã€2/">Machine Learning Yearning(å¼€ç¯‡ã€1ã€2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/01/å¼‚æ­¥IO/">å¼‚æ­¥IO</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/23/Bluestoreè°ƒç ”/">Bluestoreè°ƒç ”</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/23/RocksDBç›¸æ¯”LevelDBçš„æ–°ç‰¹æ€§/">RocksDBç›¸æ¯”LevelDBçš„æ–°ç‰¹æ€§</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/20/Kernel modules (ç®€ä½“ä¸­æ–‡)/">Kernel modules (ç®€ä½“ä¸­æ–‡)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/17/Linuxå‘½ä»¤â€”â€”pgrepå’Œpkill/">Linuxå‘½ä»¤â€”â€”pgrepå’Œpkill</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/Linuxå‘½ä»¤â€”â€”strace/">Linuxå‘½ä»¤â€”â€”strace</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/è·å–æ¯ä¸ªosdçš„PGæ•°/">è·å–æ¯ä¸ªosdçš„PGæ•°</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/RBD-ç›¸å…³æ“ä½œ/">RBD ç›¸å…³æ“ä½œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/07/åœ¨Kraken-releaseç‰ˆæœ¬ä¸Šæµ‹è¯•Ceph-BlueStore/">åœ¨Kraken releaseç‰ˆæœ¬ä¸Šæµ‹è¯•Ceph BlueStore</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/ç”¨æˆ·æ€å’Œå†…æ ¸æ€/">ç”¨æˆ·æ€å’Œå†…æ ¸æ€</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/04/cephå‡çº§åˆ°krakenç‰ˆæœ¬/">cephå‡çº§åˆ°krakenç‰ˆæœ¬</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/03/Dm-cache-vs-Bcache/">Dm-cache vs Bcache</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/03/Flashcache-vs-Cache-tier/">Flashcache vs Cache tier</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/Linuxå‘½ä»¤â€”â€”parted/">Linuxå‘½ä»¤â€”â€”parted</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/25/è®¤è¯†SSD/">è®¤è¯†SSD</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/24/Ceph-KRAKEN(V11.2.0)/">Ceph â€” V11.2.0 KRAKEN(è¯‘)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/24/Crushmapå­¦ä¹ /">Crushmapå­¦ä¹ </a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/Cephä¸­ä¸¥é‡æ•°æ®ä¸ä¸€è‡´æ€§BUG/">Cephä¸­ä¸¥é‡æ•°æ®ä¸ä¸€è‡´æ€§BUG</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/å—å­˜å‚¨çš„ä¸–ç•Œ/">å—å­˜å‚¨çš„ä¸–ç•Œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/Linuxå‘½ä»¤â€”â€”uptime/">Linuxå‘½ä»¤â€”â€”uptime</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/ddç£ç›˜å‘½ä»¤å°è®°/">ddç£ç›˜å‘½ä»¤å°è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/12/è§£å†³calamariæ— æ³•è·å–é›†ç¾¤hostsä¿¡æ¯çš„BUG/">è§£å†³calamariæ— æ³•è·å–é›†ç¾¤hostsä¿¡æ¯çš„BUG</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/ubuntuä¸‹é…ç½®é‚®ä»¶å‘é€/">ubuntuä¸‹é…ç½®é‚®ä»¶å‘é€</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/ubuntuä¸‹ç³»ç»Ÿæ‰“åŒ…/">ubuntuä¸‹ç³»ç»Ÿæ‰“åŒ…</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/Linuxå‘½ä»¤â€”â€”historyåŠå…¶ä¼˜åŒ–/">Linuxå‘½ä»¤â€”â€”historyåŠå…¶ä¼˜åŒ–</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/Linuxä¸‹åˆ©ç”¨screenè¿›è¡Œå±å¹•åä½œ/">Linuxä¸‹åˆ©ç”¨screenè¿›è¡Œå±å¹•åä½œ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/11/Linuxå‘½ä»¤â€”â€”crontab/">Linuxå‘½ä»¤â€”â€”crontab</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/06/hexoçš„æ­å»º/">Macä¸Šhexoåšå®¢çš„æ­å»º</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017 å¤å¤©çš„é£
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="ç®€è€Œä¸å‡ Hexo åŒæ åšå®¢ä¸»é¢˜  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





<div class="scroll" id="scroll">
    <a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="æŸ¥çœ‹è¯„è®º"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>